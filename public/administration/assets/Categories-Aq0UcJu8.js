import{q as y,r as i,j as e,B as t,S as c,C}from"./index-D0zBGyDj.js";import{I as n,a as f}from"./IconifyIcon-DxrtKAFV.js";import{f as S}from"./csrf-DhkfgJmo.js";import{T as o}from"./Typography-BMrFWdWq.js";import{B as I}from"./Button-Ch97SugN.js";import{A as b}from"./Alert-D0WIFuVH.js";import{C as A}from"./Card-BP9RBtBV.js";import"./useSlot-BKua55if.js";const F=()=>{const l=y(),[d,x]=i.useState([]),[j,h]=i.useState(!0),[m,a]=i.useState(""),[p,u]=i.useState("");i.useEffect(()=>{g()},[]);const g=async()=>{try{h(!0);const s=await(await fetch("/api/categories?all=1",{credentials:"include"})).json();Array.isArray(s)?x(s):x([])}catch(r){console.error("Error fetching categories:",r),a("Erreur lors du chargement des catégories")}finally{h(!1)}},w=async r=>{if(confirm("Êtes-vous sûr de vouloir supprimer cette catégorie ?"))try{const s=await S(`/api/categories/${r}`,{method:"DELETE"});if(s.ok)u("Catégorie supprimée avec succès"),g();else{const v=await s.json();a(v.error||"Erreur lors de la suppression")}}catch(s){console.error("Delete error:",s),a("Erreur lors de la suppression")}};return e.jsxs(t,{children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:4,children:[e.jsx(o,{variant:"h5",color:"common.white",children:"Catégories"}),e.jsx(I,{variant:"contained",size:"small",startIcon:e.jsx(n,{icon:"material-symbols:add"}),onClick:()=>l("/categories/new"),sx:{bgcolor:"primary.main",color:"common.black","&:hover":{bgcolor:"primary.dark"}},children:"Ajouter une catégorie"})]}),m&&e.jsx(b,{severity:"error",sx:{mb:2},onClose:()=>a(""),children:m}),p&&e.jsx(b,{severity:"success",sx:{mb:2},onClose:()=>u(""),children:p}),e.jsx(c,{spacing:1.5,children:j?e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(C,{})}):d.length===0?e.jsx(o,{color:"text.disabled",align:"center",children:"Aucune catégorie"}):d.filter(r=>!r.parentId).map(r=>e.jsxs(A,{elevation:0,sx:{p:1,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",borderRadius:2,bgcolor:"background.paper",boxShadow:"0px 2px 5px rgba(0, 0, 0, 0.05)",transition:"all 0.2s ease",width:"100%","&:hover":{transform:"translateY(-1px)",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.08)"}},children:[e.jsx(t,{sx:{width:60,height:60,borderRadius:2,mr:2,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"action.hover",overflow:"hidden"},children:r.icon?e.jsx(t,{component:"img",src:r.icon,alt:r.name,sx:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(n,{icon:"material-symbols:category",width:32,color:"text.secondary"})}),e.jsx(t,{sx:{flexGrow:1,minWidth:0,mx:2,display:"flex",alignItems:"center",justifyContent:"space-between",overflow:"hidden"},children:e.jsxs(t,{sx:{minWidth:0,mr:2,flex:1,display:"flex",flexDirection:"column",gap:.25},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(o,{variant:"subtitle2",fontWeight:700,sx:{fontSize:"0.9rem",mb:0,color:"text.primary"},children:r.name}),e.jsx(o,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{fontSize:"0.75rem",bgcolor:"action.hover",px:1,py:.5,borderRadius:1},children:r.subtitle}),e.jsx(o,{variant:"caption",sx:{fontSize:"0.75rem",bgcolor:r.isActive?"success.lighter":"action.disabledBackground",color:r.isActive?"success.dark":"text.disabled",px:1,py:.5,borderRadius:1,fontWeight:"bold"},children:r.isActive?"ACTIF":"INACTIF"})]}),(r.subcategories?.length??0)>0&&e.jsxs(o,{variant:"caption",sx:{fontSize:"0.7rem",color:"text.disabled",fontStyle:"italic",mt:.25},children:["↳ ",r.subcategories.map(s=>s.name).join(" · ")]})]})}),e.jsxs(c,{direction:"row",spacing:1,alignItems:"center",sx:{minWidth:"fit-content"},children:[e.jsx(f,{onClick:()=>l(`/categories/edit/${r.id}`),size:"small",sx:{bgcolor:"action.hover",width:32,height:32,"&:hover":{bgcolor:"primary.lighter",color:"primary.main"}},children:e.jsx(n,{icon:"material-symbols:edit-outline",width:18,height:18})}),e.jsx(f,{size:"small",onClick:()=>w(r.id),sx:{color:"error.main",bgcolor:"error.lighter",width:32,height:32,"&:hover":{bgcolor:"error.light",color:"white"}},children:e.jsx(n,{icon:"material-symbols:delete-outline",width:18})})]})]},r.id))})]})};export{F as default};
